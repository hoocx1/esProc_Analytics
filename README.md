<div align=center>
<a href="http://www.esproc.com" target="_blank" ><img src="https://img.shields.io/badge/-Scudata-red?style=social&logo=data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAyMi4xLjAsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0i5Zu+5bGCXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB2aWV3Qm94PSIwIDAgNDMuNCA2NCIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgNDMuNCA2NDsiIHhtbDpzcGFjZT0icHJlc2VydmUiPg0KPHN0eWxlIHR5cGU9InRleHQvY3NzIj4NCgkuc3Qwe2ZpbGw6IzI4ODFFRTt9DQo8L3N0eWxlPg0KPGc+DQoJPGc+DQoJCTxnPg0KCQkJPGc+DQoJCQkJPGc+DQoJCQkJCTxnPg0KCQkJCQkJPHBhdGggY2xhc3M9InN0MCIgZD0iTTE4LDQxLjhsLTUuNCwxLjVDMy41LDQ1LjYtMS45LDU1LDAuNiw2NGwwLDBMMjIsNTguM2wwLjctMC4yYzMuOS0xLjMsNi4zLTQuOSw1LjgtOC45DQoJCQkJCQkJYy0wLjEtMC45LTAuMS0xLjEtMC4yLTEuNkMyNyw0My4xLDIyLjQsNDAuNiwxOCw0MS44eiIvPg0KCQkJCQk8L2c+DQoJCQkJPC9nPg0KCQkJPC9nPg0KCQkJPHBhdGggY2xhc3M9InN0MCIgZD0iTTI4LDI1LjRsLTcuNS0xLjZjLTIuNS0xLTUuOS0yLjEtNy4zLTcuMmMtMS0zLjcsMC4yLTcuNCwyLjctOS45QzguOSw5LDQuNCwxNS40LDQuNCwyMi44DQoJCQkJYzAsNy41LDQuOCwxMy42LDExLjksMTUuN2MwLDAsNS4yLDEuNCw2LjcsMS45YzEuOSwwLjYsNS42LDIuMyw3LDYuOGMwLjEsMC4yLDAuMywxLjMsMC4zLDEuOGMwLjIsMi45LTAuNyw1LjYtMi40LDcuNg0KCQkJCWM2LjgtMi41LDExLjMtOC45LDExLjItMTYuMkMzOC44LDMzLjIsMzUuMiwyNy42LDI4LDI1LjR6Ii8+DQoJCTwvZz4NCgk8L2c+DQoJPGc+DQoJCTxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0zMS41LDEyLjlMMzEuNSwxMi45YzAtMC4yLTAuMy0xLjYtMC41LTEuOGwxMS45LTMuMmMwLjEtMC42LDAuMi0xLjMsMC4yLTEuOWwtMTYuOCw0LjQNCgkJCWMwLjcsMC42LDEuMywxLjQsMS41LDIuM2MwLjEsMC4yLDAuMSwwLjMsMC4yLDAuN2MwLDAsMCwwLjEsMCwwLjJjMC4yLDIuMy0xLjEsNC40LTMuNCw1LjFsLTAuNSwwLjFjLTIuNSwwLjYtNS4xLTEtNS44LTMuNQ0KCQkJczAuNi01LDIuOS01LjhjMC4xLDAsMC4yLTAuMSwwLjMtMC4xbDIxLjQtNS43YzAuMSwwLDAuMSwwLDAuMiwwYy0wLjEtMS4xLTAuMi0yLjQtMC42LTMuN2wwLDBMMjEuNCw1LjdsLTAuNywwLjINCgkJCWMtMy45LDEuMy02LjMsNC45LTUuOCw4LjljMC4xLDAuNSwwLDAuNiwwLjEsMC44YzAsMCwwLTAuMSwwLjEsMC44YzEuMyw0LjQsNS44LDcsMTAuMyw1LjhsNS40LTEuNWMzLjctMSw2LjYtMy4xLDguOC01LjgNCgkJCUwzMSwxNy4yYzAuMy0wLjgsMC42LTEuNiwwLjYtMi40bDkuNy0yLjZjMC4zLTAuNywwLjctMS40LDAuOS0yLjFMMzEuNSwxMi45QzMxLjUsMTMuMSwzMS41LDEzLDMxLjUsMTIuOXoiLz4NCgk8L2c+DQo8L2c+DQo8L3N2Zz4NCg==" style=" margin: 0 10px 0 0; height:25px; width: auto;"/></a> 
<a href="http://c.esproc.com" target="_blank" ><img src="https://img.shields.io/badge/-Community-red?style=social&logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAXNJREFUWEftlitLRUEURtdVEVExWUx2qxgNVouoXYtNDP4Tw20WtftAsItZrHaTYBJREZ98MAc248wcZxi4CGfSeezHmm/23kyPAa/egPPTAXQK/FsFBP7ldVDRZoqcgO9I+2bHy3ZIJBfTCPCZM1tqAxwBmzUBrNQNbEx+5b0B5oEN4NCBrAMnMaiUAuPAs3HU82TLEZwBqwGbaJ4UgKQ8CFR6SoEl4LIWwCJwZQCegKkWBWLHVKSActvdzgG3DqitDf3/VQBskBDALrDnAKXUo3ueAF5KinAf2DKOmnzD7l214bdbA6hC1XHZNQa8hSBC0hwDa57xDHDvvvWB7ciOZoE79+8CWPbsBGc769eFxJdWIKcuyIdRoG3W7AAC1dJkHDIOo8B78+4rEBo8r4AkLFk6Jk3HaeDBBTgHVmIAfpJUz+cAFXVBreQCvQYW/lqEjV1NAMUMqpAaxQMHyDnjYtuS+0BxstwaqJooFqxToFPgB5FuPCEB6XK2AAAAAElFTkSuQmCC" style=" margin: 0 10px 0 0; height:25px; width: auto;"/></a>
<a href="https://www.esproc.com/download-desktop/" target="_blank" ><img src="https://img.shields.io/badge/-Download-red?style=social&logo=data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAyMi4xLjAsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0i5Zu+5bGCXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB2aWV3Qm94PSIwIDAgMTYgMTYiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDE2IDE2OyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+DQo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPg0KCS5zdDB7ZmlsbDpub25lO3N0cm9rZTojMEY5RTAyO3N0cm9rZS13aWR0aDowLjc1O3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDt9DQoJLnN0MXtmaWxsOiMwRjlFMDI7c3Ryb2tlOiMwRjlFMDI7c3Ryb2tlLXdpZHRoOjAuNzU7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO30NCgkuc3Qye2ZpbGw6bm9uZTtzdHJva2U6I0ZGRkZGRjtzdHJva2UtbGluZWNhcDpyb3VuZDtzdHJva2UtbGluZWpvaW46cm91bmQ7fQ0KPC9zdHlsZT4NCjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0xMy44LDMuOWwtMS43LTIuMkgzLjlMMi4yLDMuOSIvPg0KPHBhdGggY2xhc3M9InN0MSIgZD0iTTIsNC4zQzIsNCwyLjMsMy43LDIuNywzLjdoMTAuN0MxMy43LDMuNywxNCw0LDE0LDQuM3Y5YzAsMC42LTAuNCwxLTEsMUgzYy0wLjYsMC0xLTAuNC0xLTFWNC4zeiIvPg0KPHBhdGggY2xhc3M9InN0MiIgZD0iTTEwLjcsOUw4LDExLjdMNS4zLDkiLz4NCjxwYXRoIGNsYXNzPSJzdDIiIGQ9Ik04LDYuM3Y1LjMiLz4NCjwvc3ZnPg0K"  style=" margin: 0 10px 0 0; height:25px; width: auto;"/></a>
<a href="https://twitter.com/esProc_SPL" target="_blank"><img src="https://img.shields.io/badge/-Twitter-red?style=social&logo=X" style=" margin: 0 10px 0 0; height:25px; width: auto;"/></a>
<a href="https://discord.gg/2bkGwqTj" target="_blank" ><img src="https://img.shields.io/badge/-discord-red?style=social&logo=discord"  style=" margin: 0 10px 0 0; height:25px; width: auto;"/></a>
<a href="https://www.reddit.com/r/esProcSPL" target="_blank" ><img src="https://img.shields.io/badge/-reddit-red?style=social&logo=reddit" style=" margin: 0 10px 0 0; height:25px; width: auto;"/></a>
<a href="https://dev.to/jbx1279" target="_blank" ><img src="https://img.shields.io/badge/-dev.to-red?style=social&logo=data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNjk3MjA5OTY2ODU0IiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjUgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjI2MDUiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMzIuMDMxMjUiIGhlaWdodD0iMzIiPjxwYXRoIGQ9Ik0yNzUuMiA0MDMuMmMtOS42LTYuNC0xNy42LTkuNi0yNy4yLTkuNkgyMDh2MjM4LjRoNDBjOS42IDAgMTcuNi0zLjIgMjcuMi05LjYgOS42LTYuNCAxMi44LTE2IDEyLjgtMzAuNFY0MzJjMC0xMi44LTQuOC0yMi40LTEyLjgtMjguOHpNOTIzLjIgMEgxMDAuOEM0NC44IDAgMCA0NC44IDAgMTAwLjh2ODI0QzAgOTc5LjIgNDQuOCAxMDI0IDEwMC44IDEwMjRoODI0YzU2IDAgMTAwLjgtNDQuOCAxMDAuOC0xMDAuOFYxMDAuOEMxMDI0IDQ0LjggOTc5LjIgMCA5MjMuMiAwek0zNTIgNTkyYzAgNDMuMi0yNy4yIDEwOC44LTExMC40IDEwOC44SDEzNlYzMjEuNmgxMDguOGM4MS42IDAgMTA4LjggNjUuNiAxMDguOCAxMDguOEwzNTIgNTkyeiBtMjMwLjQtMjAxLjZoLTEyMS42djg4aDc1LjJ2NjcuMmgtNzUuMnY4OGgxMjEuNnY2Ny4yaC0xNDIuNGMtMjUuNiAwLTQ2LjQtMTkuMi00OC00NC44VjM2OS42YzAtMjUuNiAxOS4yLTQ2LjQgNDQuOC00OGgxNDRsMS42IDY4Ljh6IG0yMzYuOCAyNjIuNGMtMzAuNCA3MC40LTg0LjggNTYtMTA4LjggMGwtODgtMzMxLjJoNzUuMmw2Ny4yIDI1OS4yTDgzMiAzMjEuNmg3NS4ybC04OCAzMzEuMnoiIHAtaWQ9IjI2MDYiIGZpbGw9IiMwMDAwMDAiPjwvcGF0aD48L3N2Zz4=" style=" margin: 0 10px 0 0; height:25px; width: auto;"/></a>
</div>




![image](https://www.esproc.com/images/data-analysis/0.png)

<div align="center">
    <h2>Novel grid-style programming</h2>
</div> 

<div align="center">
    <h3>Excel-like Grid-style programming</h3>
</div> 

![image](https://www.esproc.com/wp-content/themes/scudata-en/images/Langding-Page-SPL-Data-Analysis/1.png)

---
 

![image](https://www.esproc.com/wp-content/themes/scudata-en/images/Langding-Page-SPL-Data-Analysis/2.gif)

---

<div align="center">
    <h3>High Interactivity for Exploratory Analysis</h3>
</div>  

![image](https://www.esproc.com/wp-content/themes/scudata-en/images/Langding-Page-SPL-Data-Analysis/4.gif)

---

<div align="center">
    <h3>XLL Plugin Helps Excel</h3>
</div>  


Write SPL code in Excel directly

> **Finding periods during which stocks have risen consecutively for more than 5 days**

```
=spl("=E(?1).sort(CODE,DT).group@i(CODE!=CODE[-1]||CL<CL[-1]).select(~.len()>=5).conj()",A1:D253)
```
 
<div align="center"> 
    <img src="https://www.esproc.com/wp-content/themes/scudata-en/images/Langding-Page-SPL-Data-Analysis/5.png" width="60%" />
</div>
 
---

<div align="center">
    <h2>Concise and Powerful Code</h2>
</div> 

<div align="center">
    <h3>Comprehensive and Simple Operations</h3>
</div> 

![image](https://www.esproc.com/wp-content/themes/scudata-en/images/Langding-Page-SPL-Data-Analysis/6.png)

---

<div align="center">
    <h3>Unique Set and Ordered Operations</h3>
</div> 

> **calculate the longest consecutive rising days for each stock**

#### SQL

```sql
SELECT CODE, MAX(con_rise) AS longest_up_days
FROM (
    SELECT CODE, COUNT(*) AS con_rise
    FROM (
        SELECT CODE, DT,  SUM(updown_flag) OVER (PARTITION BY CODE ORDER BY CODE, DT) AS no_up_days
        FROM (
            SELECT CODE, DT, 
                    CASE WHEN CL > LAG(CL) OVER (PARTITION BY CODE ORDER BY CODE, DT)  THEN 0
                    ELSE 1 END AS updown_flag
            FROM stock
        )
    )
    GROUP BY CODE, no_up_days
)
GROUP BY CODE
```
#### Python
```Python
import pandas as pd
stock_file = "StockRecords.txt"
stock_info = pd.read_csv(stock_file,sep="\t")
stock_info.sort_values(by=['CODE','DT'],inplace=True)
stock_group = stock_info.groupby(by='CODE')
stock_info['label'] = stock_info.groupby('CODE')['CL'].diff().fillna(0).le(0).astype(int).cumsum()
max_increase_days = {}
for code, group in stock_info.groupby('CODE'):
    max_increase_days[code] = group.groupby('label').size().max() â€“ 1
max_rise_df = pd.DataFrame(list(max_increase_days.items()), columns=['CODE', 'max_increase_days'])
```

#### SPL
 

|   | A |
| --- | --- |
| 1 | StockRecords.xlsx |
| 2 | =T(A1).sort(DT) |
| 3 | =A2.group(CODE;\~.group@i(CL< CL[-1]).max(~.len()):max_increase_days) |

**Especially skilled at complex scenarios such as order-related operations, sliding windows, and cross-row computations, much simpler than SQL or Python**


[What to use for data analysis programming: SPL,Python or SPL?](https://www.esproc.com/langding-page-scientist/)

---

<div align="center">
    <h3>Easy Big Data and Parallel Support</h3>
</div> 

![image](https://www.esproc.com/wp-content/themes/scudata-en/images/Langding-Page-SPL-Data-Analysis/8.png)


---

<div align="center">
    <h3>Lightweight and Portable</h3>
</div>  

<div align="center"> 
    <img src="https://www.esproc.com/wp-content/themes/scudata-en/images/Langding-Page-SPL-Data-Analysis/9.png" width="60%" />
</div>

---

# Resource

- [Read the e-book "SPL Programming"](https://www.esproc.com/html/SPL-programming-book.html)
- [Watch the video "SPL video course"](https://www.esproc.com/html/SPL-programming-course.html)
- [Download esProc Desktop](https://www.esproc.com/download-desktop/)
- [Community - c.esproc.com](https://c.esproc.com/)
